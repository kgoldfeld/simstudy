<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ordinal Categorical Data • simstudy</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Ordinal Categorical Data">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simstudy</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.8.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/simstudy.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/clustered.html">Clustered Data</a>
    </li>
    <li>
      <a href="../articles/corelationmat.html">Correlation Matrices</a>
    </li>
    <li>
      <a href="../articles/correlated.html">Correlated Data</a>
    </li>
    <li>
      <a href="../articles/customdist.html">Customized Distributions</a>
    </li>
    <li>
      <a href="../articles/double_dot_extension.html">Dynamic Data Definition</a>
    </li>
    <li>
      <a href="../articles/logisticCoefs.html">Targeted logistic model coefficients</a>
    </li>
    <li>
      <a href="../articles/longitudinal.html">Longitudinal Data</a>
    </li>
    <li>
      <a href="../articles/missing.html">Missing Data</a>
    </li>
    <li>
      <a href="../articles/ordinal.html">Ordinal Categorical Data</a>
    </li>
    <li>
      <a href="../articles/spline.html">Spline Data</a>
    </li>
    <li>
      <a href="../articles/survival.html">Survival Data</a>
    </li>
    <li>
      <a href="../articles/treat_and_exposure.html">Treatment and Exposure</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kgoldfeld/simstudy/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Ordinal Categorical Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kgoldfeld/simstudy/blob/main/vignettes/ordinal.Rmd" class="external-link"><code>vignettes/ordinal.Rmd</code></a></small>
      <div class="hidden name"><code>ordinal.Rmd</code></div>

    </div>

    
    
<p>Using the <code>defData</code> and <code>genData</code> functions, it
is relatively easy to specify multinomial distributions that
characterize categorical data. Order becomes relevant when the
categories take on meanings related to strength of opinion or agreement
(as in a Likert-type response) or frequency. A motivating example could
be when a response variable takes on four possible values: (1) strongly
disagree, (2) disagree, (4) agree, (5) strongly agree. There is a
natural order to the response possibilities.</p>
<p>It is common to summarize the data by looking at <em>cumulative</em>
probabilities, odds, or log-odds. Comparisons of different exposures or
individual characteristics typically look at how these cumulative
measures vary across the different exposures or characteristics. So, if
we were interested in cumulative odds, we would compare <span class="math display">$$\small{\frac{P(response = 1|exposed)}{P(response
&gt; 1|exposed)} \ \ vs. \ \frac{P(response = 1|unexposed)}{P(response
&gt; 1|unexposed)}},$$</span></p>
<p>and continue until the last (in this case, third) comparison</p>
<p><span class="math display">$$\small{\frac{P(response \le
3|exposed)}{P(response &gt; 3|exposed)} \ \ vs. \ \frac{P(response \le
3|unexposed)}{P(response &gt; 3|unexposed)}},$$</span></p>
<p>We can use an underlying (continuous) latent process as the basis for
data generation. If we assume that probabilities are determined by
segments of a logistic distribution (see below), we can define the
ordinal mechanism using thresholds along the support of the
distribution. If there are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
possible responses (in the meat example, we have 4), then there will be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k-1</annotation></semantics></math>
thresholds. The area under the logistic density curve of each of the
regions defined by those thresholds (there will be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
distinct regions) represents the probability of each possible response
tied to that region.</p>
<pre><code><span><span class="co">## Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2</span></span>
<span><span class="co">## 3.5.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use the `legend.position.inside` argument of `theme()` instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<p><img src="ordinal_files/figure-html/threshold-1.png" width="504"></p>
<div class="section level2">
<h2 id="comparing-response-distributions-of-different-populations">Comparing response distributions of different populations<a class="anchor" aria-label="anchor" href="#comparing-response-distributions-of-different-populations"></a>
</h2>
<p>In the cumulative logit model, the underlying assumption is that the
odds ratio of one population relative to another is constant across all
the possible responses. This means that all of the cumulative odds
ratios are equal:</p>
<p><span class="math display">$$\small{\frac{codds(P(Resp = 1 |
exposed))}{codds(P(Resp = 1 | unexposed))} =  \ ... \ =
\frac{codds(P(Resp \leq 3 | exposed))}{codds(P(Resp \leq 3 |
unexposed))}}$$</span></p>
<p>In terms of the underlying process, this means that each of the
thresholds shifts the same amount (as shown below) where we add 0.7
units to each threshold that was set for the exposed group. What this
effectively does is create a greater probability of a lower outcome for
the unexposed group.</p>
<pre><code><span><span class="co">## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<p><img src="ordinal_files/figure-html/plotB-1.png" width="504"></p>
</div>
<div class="section level2">
<h2 id="the-cumulative-proportional-odds-model">The cumulative proportional odds model<a class="anchor" aria-label="anchor" href="#the-cumulative-proportional-odds-model"></a>
</h2>
<p>In the <code>R</code> package <code>ordinal</code>, the model is fit
using function <code>clm</code>. The model that is being estimated has
the form</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>R</mi><mi>e</mi><mi>s</mi><mi>p</mi><mo>≤</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>R</mi><mi>e</mi><mi>s</mi><mi>p</mi><mo>&gt;</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="false" form="prefix">|</mo><mi>G</mi><mi>r</mi><mi>o</mi><mi>u</mi><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>α</mi><mi>i</mi></msub><mo>−</mo><mi>β</mi><mo>*</mo><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>G</mi><mi>r</mi><mi>o</mi><mi>u</mi><mi>p</mi><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mi>o</mi><mi>s</mi><mi>e</mi><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mo>,</mo><mspace width="0.222em"></mspace><mi>i</mi><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">log \left( \frac{P(Resp \leq  i)}{P(Resp &gt; i)} | Group \right) = \alpha_i - \beta*I(Group=exposed) \  \ , \ i \in \{1, 2, 3\}</annotation></semantics></math></p>
<p>The model specifies that the cumulative log-odds for a particular
category is a function of two parameters,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\alpha_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>.
(Note that in this parameterization and the model fit,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">-\beta</annotation></semantics></math>
is used.)
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\alpha_i</annotation></semantics></math>
represents the cumulative log odds of being in category
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
or lower for those in the reference exposure group, which in our example
is Group A.
<em><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\alpha_i</annotation></semantics></math>
also represents the threshold of the latent continuous (logistic) data
generating process.</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
is the cumulative log-odds ratio for the category
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
comparing the unexposed to reference group, which is the exposed.
<em><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
also represents the shift of the threshold on the latent continuous
process for the exposed relative to the unexposed</em>. The
proportionality assumption implies that the shift of the threshold for
each of the categories is identical.</p>
</div>
<div class="section level2">
<h2 id="simulation">Simulation<a class="anchor" aria-label="anchor" href="#simulation"></a>
</h2>
<p>To generate ordered categorical data using <code>simstudy</code>,
there is a function <code>genOrdCat</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baseprobs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.31</span>, <span class="fl">0.29</span>, <span class="fl">.20</span>, <span class="fl">0.20</span><span class="op">)</span></span>
<span></span>
<span><span class="va">defA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defData.html">defData</a></span><span class="op">(</span>varname <span class="op">=</span> <span class="st">"exposed"</span>, formula <span class="op">=</span> <span class="st">"1;1"</span>, dist <span class="op">=</span> <span class="st">"trtAssign"</span><span class="op">)</span></span>
<span><span class="va">defA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defData.html">defData</a></span><span class="op">(</span><span class="va">defA</span>, varname <span class="op">=</span> <span class="st">"z"</span>, formula <span class="op">=</span> <span class="st">"-0.7*exposed"</span>, dist <span class="op">=</span> <span class="st">"nonrandom"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">130</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dT_1_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/genData.html">genData</a></span><span class="op">(</span><span class="fl">25000</span>, <span class="va">defA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dX</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/genOrdCat.html">genOrdCat</a></span><span class="op">(</span><span class="va">dT_1_cat</span>, adjVar <span class="op">=</span> <span class="st">"z"</span>, <span class="va">baseprobs</span>, catVar <span class="op">=</span> <span class="st">"r"</span><span class="op">)</span></span></code></pre></div>
<p>Estimating the parameters of the model using function
<code>clm</code>, we can recover the original parameters quite well.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/runehaubo/ordinal" class="external-link">ordinal</a></span><span class="op">)</span></span>
<span><span class="va">clmFit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ordinal/man/clm.html" class="external-link">clm</a></span><span class="op">(</span><span class="va">r</span> <span class="op">~</span> <span class="va">exposed</span>, data <span class="op">=</span> <span class="va">dX</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">clmFit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## formula: r ~ exposed</span></span>
<span><span class="co">## data:    dX</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  link  threshold nobs  logLik    AIC      niter max.grad cond.H </span></span>
<span><span class="co">##  logit flexible  25000 -32339.34 64686.68 4(0)  3.11e-08 1.7e+01</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##         Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## exposed  -0.7576     0.0234   -32.4   &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Threshold coefficients:</span></span>
<span><span class="co">##     Estimate Std. Error z value</span></span>
<span><span class="co">## 1|2  -0.8391     0.0180   -46.7</span></span>
<span><span class="co">## 2|3   0.3768     0.0173    21.8</span></span>
<span><span class="co">## 3|4   1.3696     0.0201    68.3</span></span></code></pre>
<p>In the model output, the <code>exposed</code> coefficient of -1.15 is
the estimate of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">-\beta</annotation></semantics></math>
(i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>β</mi><mo accent="true">̂</mo></mover><mo>=</mo><mn>1.15</mn></mrow><annotation encoding="application/x-tex">\hat{\beta} = 1.15</annotation></semantics></math>),
which was set to -1.1 in the simulation. The threshold coefficients are
the estimates of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\alpha_i</annotation></semantics></math>’s
in the model - and match the thresholds for the unexposed group.</p>
<p>The log of the cumulative odds for groups 1 to 4 from the data
without exposure are</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">logOdds.unexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu">odds</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">dX</span><span class="op">[</span><span class="va">exposed</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     1     2     3 </span></span>
<span><span class="co">## -0.83  0.38  1.36</span></span></code></pre>
<p>And under exposure:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">logOdds.expos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu">odds</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">dX</span><span class="op">[</span><span class="va">exposed</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      1      2      3 </span></span>
<span><span class="co">## -0.084  1.135  2.147</span></span></code></pre>
<p>The log of the cumulative odds ratios for each of the four groups
is</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">logOdds.expos</span> <span class="op">-</span> <span class="va">logOdds.unexp</span></span></code></pre></div>
<pre><code><span><span class="co">##    1    2    3 </span></span>
<span><span class="co">## 0.75 0.76 0.79</span></span></code></pre>
<p>A plot of the modeled cumulative probabilities (the lines) shows that
the proportionality assumption fit the observed data (the points) quite
well.</p>
<p><img src="ordinal_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="non-proportional-odds">Non-proportional odds<a class="anchor" aria-label="anchor" href="#non-proportional-odds"></a>
</h2>
<p>By default, the function <code>genOrdCat</code> generates ordinal
categorical data under the assumption of proportional cumulative odds.
On the underlying logistic scale, this means that there is a consistent
shift of the thresholds; in the initial example above, the exposure
thresholds were shifted 0.7 units to the right on the logistic scale. In
the figure below, the rightward shift of the threshold to the left
varies for each threshold (0.4 units for the first threshold, 0.0 for
the second, and 1.7 for the last), which violates the underlying
assumption of proportionality:</p>
<p><img src="ordinal_files/figure-html/plotNP-1.png" width="504"></p>
<p>It is possible to generate data under these assumptions using the
<code>npVar</code> and <code>npAdj</code> arguments. <code>npVar</code>
indicates the variable(s) for which the non-proportional assumption is
violated, and <code>npAdj</code> indicates the various shifts of the
intervals. (Note that the last cut point is at <code>Inf</code>, so
there is no impact of a shift related to that threshold.)</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baseprobs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.31</span>, <span class="fl">0.29</span>, <span class="fl">.20</span>, <span class="fl">0.20</span><span class="op">)</span></span>
<span><span class="va">npAdj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.0</span>, <span class="op">-</span><span class="fl">1.7</span>, <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dX</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/genOrdCat.html">genOrdCat</a></span><span class="op">(</span><span class="va">dT_1_cat</span>, baseprobs <span class="op">=</span> <span class="va">baseprobs</span>, adjVar <span class="op">=</span> <span class="st">"z"</span>,</span>
<span>                catVar <span class="op">=</span> <span class="st">"r"</span>, npVar <span class="op">=</span> <span class="st">"exposed"</span>, npAdj <span class="op">=</span> <span class="va">npAdj</span><span class="op">)</span></span></code></pre></div>
<p>The calculation of the log cumulative odds follows as before:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">logOdds.unexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu">odds</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">dX</span><span class="op">[</span><span class="va">exposed</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     1     2     3 </span></span>
<span><span class="co">## -0.80  0.42  1.40</span></span></code></pre>
<p>And under exposure:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">logOdds.expos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu">odds</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">dX</span><span class="op">[</span><span class="va">exposed</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    1    2    3 </span></span>
<span><span class="co">## 0.29 1.10 3.72</span></span></code></pre>
<p>But, now, the log of the cumulative odds ratios for each of the four
groups varies across the different levels.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">logOdds.expos</span> <span class="op">-</span> <span class="va">logOdds.unexp</span></span></code></pre></div>
<pre><code><span><span class="co">##    1    2    3 </span></span>
<span><span class="co">## 1.09 0.69 2.32</span></span></code></pre>
<p>This is confirmed by a plot of the model fit with a proportional odds
assumption along with the observed cumulative proportions. Since the
model imposes a consistent shift of each threshold, the observed points
no longer lie along the prediction line, indicating a violation of the
proportional odds assumption:</p>
<p><img src="ordinal_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="correlated-multivariate-ordinal-data">Correlated multivariate ordinal data<a class="anchor" aria-label="anchor" href="#correlated-multivariate-ordinal-data"></a>
</h2>
<p>Function <code>genOrdCat</code> generates multiple categorical
response variables that may be correlated. For example, a survey of
multiple Likert-type questions could have many response variables. The
function generates correlated latent variables (using a normal copula)
to simulate correlated categorical outcomes. The user specifies a matrix
of probabilities, with each row representing a single item or
categorical variable. The across each row must be 1. Adjustment
variables can be specified for each item, or a single adjustment
variable can be specified for all items. The correlation is on the
standard normal scale and is specified with a value of <code>rho</code>
and a correlation structure (<em>independence</em>, <em>compound
symmetry</em>, or <em>AR-1</em>). Alternatively, a correlation matrix
can be specified.</p>
<p>In this example, there are 5 questions, each of which has three
possible responses: “none”, “some”, “a lot”. The probabilities of
response are specified in a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mo>×</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">5 \times 3</annotation></semantics></math>
matrix, and the rows sum to 1:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baseprobs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.7</span>,</span>
<span>                      <span class="fl">0.7</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>,</span>
<span>                      <span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>,</span>
<span>                      <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>,</span>
<span>                      <span class="fl">0.6</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span>, </span>
<span>                    nrow <span class="op">=</span> <span class="fl">5</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># generate the data</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">333</span><span class="op">)</span>                     </span>
<span><span class="va">dT_5_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/genData.html">genData</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dX</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/genOrdCat.html">genOrdCat</a></span><span class="op">(</span><span class="va">dT_5_cat</span>, adjVar <span class="op">=</span> <span class="cn">NULL</span>, baseprobs <span class="op">=</span> <span class="va">baseprobs</span>, </span>
<span>                   prefix <span class="op">=</span> <span class="st">"q"</span>, rho <span class="op">=</span> <span class="fl">0.15</span>, corstr <span class="op">=</span> <span class="st">"cs"</span>, asFactor <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>The observed correlation of the items is slightly less than the
specified correlations as expected:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">dX</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">q1</span>, <span class="va">q2</span>, <span class="va">q3</span>, <span class="va">q4</span>, <span class="va">q5</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      q1   q2   q3   q4   q5</span></span>
<span><span class="co">## q1 1.00 0.08 0.10 0.10 0.08</span></span>
<span><span class="co">## q2 0.08 1.00 0.09 0.09 0.09</span></span>
<span><span class="co">## q3 0.10 0.09 1.00 0.11 0.11</span></span>
<span><span class="co">## q4 0.10 0.09 0.11 1.00 0.10</span></span>
<span><span class="co">## q5 0.08 0.09 0.11 0.10 1.00</span></span></code></pre>
<p>However, the marginal probability distributions of each item match
quite closely with the specified probabilities:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/melt.data.table.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">dX</span>, id.vars <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span><span class="va">dProp</span> <span class="op">&lt;-</span> <span class="va">dM</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">variable</span><span class="op">]</span></span>
<span><span class="va">dProp</span><span class="op">[</span>, <span class="va">response</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># observed probabilities</span></span>
<span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/dcast.data.table.html" class="external-link">dcast</a></span><span class="op">(</span><span class="va">dProp</span>, <span class="va">variable</span> <span class="op">~</span> <span class="va">response</span>, value.var <span class="op">=</span> <span class="st">"V1"</span>, fill <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;variable&gt;</span></span>
<span><span class="co">##    variable       1       2       3</span></span>
<span><span class="co">##      &lt;fctr&gt; &lt;table&gt; &lt;table&gt; &lt;table&gt;</span></span>
<span><span class="co">## 1:       q1    0.20    0.10    0.70</span></span>
<span><span class="co">## 2:       q2    0.69    0.21    0.10</span></span>
<span><span class="co">## 3:       q3    0.50    0.20    0.30</span></span>
<span><span class="co">## 4:       q4    0.40    0.20    0.40</span></span>
<span><span class="co">## 5:       q5    0.60    0.20    0.21</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># specified probabilities</span></span>
<span><span class="va">baseprobs</span></span></code></pre></div>
<pre><code><span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]  0.2  0.1  0.7</span></span>
<span><span class="co">## [2,]  0.7  0.2  0.1</span></span>
<span><span class="co">## [3,]  0.5  0.2  0.3</span></span>
<span><span class="co">## [4,]  0.4  0.2  0.4</span></span>
<span><span class="co">## [5,]  0.6  0.2  0.2</span></span></code></pre>
<p>In the next example, the structure of the correlation is changed to
AR-1, so the correlation between questions closer to each other is
higher than for questions farther apart. But the probability
distributions are unaffected:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dX</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/genOrdCat.html">genOrdCat</a></span><span class="op">(</span><span class="va">dT_5_cat</span>, adjVar <span class="op">=</span> <span class="cn">NULL</span>, baseprobs <span class="op">=</span> <span class="va">baseprobs</span>, </span>
<span>                   prefix <span class="op">=</span> <span class="st">"q"</span>, rho <span class="op">=</span> <span class="fl">0.40</span>, corstr <span class="op">=</span> <span class="st">"ar1"</span>, asFactor <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># correlation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">dX</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">q1</span>, <span class="va">q2</span>, <span class="va">q3</span>, <span class="va">q4</span>, <span class="va">q5</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      q1   q2   q3   q4   q5</span></span>
<span><span class="co">## q1 1.00 0.22 0.10 0.05 0.02</span></span>
<span><span class="co">## q2 0.22 1.00 0.29 0.10 0.03</span></span>
<span><span class="co">## q3 0.10 0.29 1.00 0.31 0.11</span></span>
<span><span class="co">## q4 0.05 0.10 0.31 1.00 0.29</span></span>
<span><span class="co">## q5 0.02 0.03 0.11 0.29 1.00</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/melt.data.table.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">dX</span>, id.vars <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span><span class="va">dProp</span> <span class="op">&lt;-</span> <span class="va">dM</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">variable</span><span class="op">]</span></span>
<span><span class="va">dProp</span><span class="op">[</span>, <span class="va">response</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># probabilities</span></span>
<span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/dcast.data.table.html" class="external-link">dcast</a></span><span class="op">(</span><span class="va">dProp</span>, <span class="va">variable</span> <span class="op">~</span> <span class="va">response</span>, value.var <span class="op">=</span> <span class="st">"V1"</span>, fill <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;variable&gt;</span></span>
<span><span class="co">##    variable       1       2       3</span></span>
<span><span class="co">##      &lt;fctr&gt; &lt;table&gt; &lt;table&gt; &lt;table&gt;</span></span>
<span><span class="co">## 1:       q1    0.20    0.10   0.692</span></span>
<span><span class="co">## 2:       q2    0.70    0.20   0.099</span></span>
<span><span class="co">## 3:       q3    0.50    0.20   0.300</span></span>
<span><span class="co">## 4:       q4    0.39    0.21   0.397</span></span>
<span><span class="co">## 5:       q5    0.60    0.19   0.204</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://www.rdatagen.net/" class="external-link">Keith Goldfeld</a>, Jacob Wujciak-Jens.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.9000.</p>
</div>

      </footer>
</div>






  </body>
</html>
